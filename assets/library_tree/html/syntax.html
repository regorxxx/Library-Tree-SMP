<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">

<head>
	<title>Library-Tree-SMP Syntax Help</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" type="text/css" href="syntax.css" />
</head>

<body>
	<div class="dokuwiki export">
		<div class="toc">
			<div class="tocheader toctoggle" id="toc__header">Table of Contents</div>
			<div id="toc__inside">
				<ul class="toc">
					<div class="li"><span class="li"><a href="#query_syntax_help" class="toc">Syntax Help</a></span></div>
					<ul class="toc">
						<li class="level1">
							<div class="li"><span class="li"><a href="#view_summary" class="toc">Views</a></span></div>
						</li>
						<li class="level1">
							<div class="li"><span class="li"><a href="#filter_summary" class="toc">Filters and Search box</a></span></div>
						</li>
						<li class="level1">
							<div class="li"><span class="li"><a href="#sorting_summary" class="toc">Playlist and Top tracks Sorting</a></span></div>
						</li>
					</ul>
				</ul>
			</div>
		</div>



		<h1><a name="query_syntax_help" id="query_syntax_help">Library-Tree-SMP Syntax Help</a></h1>
		<div class="level1"></div>
		<!-- SECTION "Views" -->
		<h2><a name="view_summary" id="view_summary">Views</a></h2>
		<div class="level2">
			<table class="inline" style="width: 99%;">
				<tr>
					<th> Function </th>
					<th> Description </th>
					<th> Example </th>
					<th> Comment </th>
				</tr>
				<tr>
					<td> <em>%&ltfield&gt%</em> </td>
					<td> Splits multiple values into separate items. </td>
					<td> <em>%&ltartist&gt%</em> </td>
					<td> Splits artists into same level. </td>
				</tr>
				<tr>
					<td> <em>$stripbranchprefix{%&ltfield&gt%}</em> </td>
					<td> Same as above, additionally removes prefixes (like leading "The" or "A") from each value. </td>
					<td> <em>use $stripbranchprefix{%&ltartist&gt%}</em> </td>
					<td> Splits artists and removes prefixes. </td>
				</tr>
				<tr>
					<td> <em>$swapbranchprefix{%&ltfield&gt%}</em> </td>
					<td> Same as above, additionally moves prefixes (like leading "The" or "A") to end of each value. </td>
					<td> <em>$swapbranchprefix{%&ltartist&gt%}</em> </td>
					<td> Splits artists and swaps prefixes to end. </td>
				</tr>
				<tr>
					<td> <em>%field1%&#166%field2%&#166...</em> </td>
					<td> &#166 combines different fields into the same branch level </td>
					<td> <em>%album artist%&#166%artist%</em> </td>
					<td> Merges album artists and artists into same level. </td>
				</tr>
				<tr>
					<td> <em>$nodisplay{X}</em> </td>
					<td> Sorts and groups by X (TF expression) without displaying the result.</td>
					<td> <em>%artist%|$nodisplay{$sub(99999,%date%)}%album%[ &#39[&#39%date%&#39]&#39]|%tracknumber%. %title%</em> </td>
					<td> Sorts latest albums first and displays the date. </td>
				</tr>
				<tr>
					<td> <em>$colour{normal,hover,selected}</em> </td>
					<td> Sets different colours for parts of a line of text, see below for more info. </td>
					<td>
						<em>
							$colour{255-0-0}
							<br>
							<br>
							$colour{}
							<br>
							<br>
							$colour{,,+++}
						</em>
					</td>
					<td>
						Sets normal colour to red; hover and selected colours to defaults.
						<br>
						<br>
						Resets all colours to defaults.
						<br>
						<br>
						Sets selected colour to brightest, normal and hover colours to defaults.
					</td>
				</tr>
			</table>
		</div>
		<!-- SECTION "Views" -->
		<!-- SECTION "Filters and Search box" -->
		<h2><a name="filter_summary" id="filter_summary">Filters and Search box</a></h2>
		<div class="level2">
			<table class="inline" style="width: 99%;">
				<tr>
					<th> Function </th>
					<th> Description </th>
					<th> Example </th>
					<th> Comment </th>
				</tr>
				<tr>
					<td> <em>$nowplaying{X}</em> </td>
					<td> Returns value of X (TF expression) for the playing track. </td>
					<td> <em>ARTIST IS $nowplaying{$meta(ARTIST,0)}</em> </td>
					<td> Displays tracks by nowplaying artist. </td>
				</tr>
				<tr>
					<td> <em>$selected{X}</em> </td>
					<td> Returns value of X (TF expression) for the selected track. </td>
					<td> <em>ARTIST IS $selected{$meta(ARTIST,0)}</em> </td>
					<td> Displays tracks by selected (focused) artist. </td>
				</tr>
				<tr>
					<td> <em>$nowplayingorselected{X}</em> </td>
					<td> Returns value of X (TF expression) for the playing or selected (focused) track as fallback. </td>
					<td> <em>ARTIST IS $nowplayingorselected{$meta(ARTIST,0)}</em> </td>
					<td> Displays tracks by nowplaying arist while playing, selected (focused) artist otherwise. </td>
				</tr>
				<tr>
					<td> <em>$searchtext</em> </td>
					<td> Returns search text into the filter pattern.</td>
					<td>
						Filter: <em>GENRE HAS $searchtext</em>
						<br>
						Search box: <em>rock</em>
					</td>
					<td>
						Use example as filter, then type "rock" in search box.
						<br>
						Result: "GENRE HAS rock"
					</td>
				</tr>
			</table>
		</div>
		<!-- SECTION "Filters and Search box" -->
		<!-- SECTION "Sorting" -->
		<h2><a name="sorting_summary" id="sorting_summary">Playlist and Top tracks Sorting</a></h2>
		<div class="level2">
			<table class="inline" style="width: 99%;">
				<tr>
					<th> Function </th>
					<th> Description </th>
					<th> Example </th>
					<th> Comment </th>
				</tr>
				<tr>
					<td> <em>$rand()</em> </td>
					<td> Random sorting. </td>
					<td>
						<em>
							$rand()
							<br>
							<br>
							$if($meta_test(COMPILATION),$rand(),0)
						</em>
					</td>
					<td>
						Shuffles all tracks randomly.
						<br>
						<br>
						Shuffles all tracks with a COMPILATION tag randomly, any other track follows panel sorting.
					</td>
				</tr>
				<tr>
					<td> <em>$harmonicsort{bShuffle}</em> </td>
					<td>
						Sorting by incremental KEY.
						<br>
						&emsp;&#x2219; Set <b>bShuffle</b> to <i>true</i>, <i>1</i>, any string or empty to shuffle.
						<br>
						&emsp;&#x2219; Set <b>bShuffle</b> to <i>false</i> or <i>0</i> to skip shuffling.
					</td>
					<td>
						<em>
							$harmonicsort{1}
							<br>
							<br>
							$harmonicsort{false}
						</em>
					</td>
					<td>
						Shuffles all tracks and then sorts by KEY.
						<br>
						<br>
						Sorts by KEY.
					</td>
				</tr>
				<tr>
					<td> <em>$harmonicmix{bShuffle}</em> </td>
					<td>
						Sorting by harmonic mixing rules.
						<br>
						&emsp;&#x2219; Set <b>bShuffle</b> to <i>true</i>, <i>1</i>, any string or empty to shuffle.
						<br>
						&emsp;&#x2219; Set <b>bShuffle</b> to <i>false</i> or <i>0</i> to skip shuffling.
					</td>
					<td>
						<em>
							$harmonicmix{}
							<br>
							<br>
							$harmonicmix{0}
						</em>
					</td>
					<td>
						Shuffles all tracks and then does harmonic mixing.
						<br>
						<br>
						Does harmonic mixing.
					</td>
				</tr>
				<tr>
					<td> <em>$shufflebytags{tagName,sortBias,sortDir}</em> </td>
					<td>
						Scatters tracks with same tag values semi-randomly.
						<br>
						&emsp;&#x2219; <b>tagName</b> can be set to any tag -<i>ARTIST</i>- or array of tags -<i>["ARTIST","ALBUM ARTIST"]</i>-
						<br>
						&emsp;&#x2219; <b>sortBias</b> can set to: <i>playcount, rating, popularity, lastplayed, key, key6acentered, random, none</i> Or omitted (<i>random</i> used).
						<br>
						&emsp;&#x2219; <b>sortDir</b> can be set to <i>1</i>, <i>-1</i> or omitted (<i>1</i> used).
					</td>
					<td>
						<em>
							$shufflebytags{["ARTIST","ALBUM ARTIST"],random,1}
							<br>
							<br>
							$shufflebytags{"GENRE",rating,-1}
							<br>
							<br>
							$shufflebytags{["GENRE","STYLE"],key6acentered,-1}
						</em>
					</td>
					<td>
						Shuffles all tracks by ARTIST and ALBUM ARTIST, trying to scatter values from any of them, with a random bias.
						<br>
						<br>
						Shuffles all tracks by GENRE, with a rating bias, putting lower rated tracks first.
						<br>
						<br>
						Shuffles all tracks by GENRE and STYLE, with a key 6A centered bias, putting tracks with a Camelot Key equivalent to 6A first and slowly adding higher/lower keys.
					 </td>
				</tr>
				<tr>
					<td> <em>$nowplaying{X}</em> </td>
					<td> Returns value of X (TF expression) for the playing track. </td>
					<td> <em>$if($strcmp(%ARTIST%,$nowplaying{%ARTIST%}),0,1)</em> </td>
					<td> Puts nowplaying artist first, then follows panel sorting. </td>
				</tr>
				<tr>
					<td> <em>$selected{X}</em> </td>
					<td> Returns value of X (TF expression) for the selected track. </td>
					<td> <em>$if($strcmp(%ARTIST%,$nowplaying{%ARTIST%}),0,1)$harmonicmix{}</em> </td>
					<td> Performs harmonic mixing, then puts selected (focused) artist first, leaving the rest as previously sorted. </td>
				</tr>
				<tr>
					<td> <em>$nowplayingorselected{X}</em> </td>
					<td> Returns value of X (TF expression) for the playing or selected (focused) track as fallback. </td>
					<td> <em>$if($strcmp(Rock,$nowplayingorselected{$meta(GENRE,0)}),$rand(),0)$harmonicmix{}</em> </td>
					<td> Performs harmonic mixing and when playing or selecting a Rock track applies a random sorting. </td>
				</tr>
			</table>
		</div>
		<!-- SECTION "Sorting" -->
	</div>
</body>

</html>
